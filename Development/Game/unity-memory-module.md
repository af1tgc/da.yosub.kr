---
title: Unity - Checking Module on Memory, after Injection with SharpMonoInjector
description: 
published: true
date: 2023-05-15T09:16:23.327Z
tags: security, c#, dll, dll-injection, penetration-testing
editor: markdown
dateCreated: 2023-05-15T09:11:34.286Z
---

# SharpMonoInjector
[SharpMonoInjector](/Development/Game/Unity-SharpMonoInjector) 구동 방식에 따라, 프로세스의 dll 리스트에서 악성 동작을 쉽게 확인할 수 없다. 조금 더 상세히 서술하자면 작성한 dll 파일이 process에 주입되는 형태가 아니라 온메모리상의 `mono.dll`에 작성한 module의 address로 변경하는 구조이기 때문이다.
따라서, 메모리 상의 `mono.dll` 의 바이너리를 읽고 대조하는 식으로 주입이 되었음을 확인할 수 있을 것이라 판단하였다.

# 코드 변경
## 개념
기본적으로 [SharpMonoInjector](/Development/Game/Unity-SharpMonoInjector) 에서 사용하는 기능을 활용하였다.
* 프로세스를 읽어와 mono.dll을 찾고 `mono_get_root_domain`의 lpBase를 찾는다.
* 하위 세부 모듈의 Address를 구한다.
* 샘플 모듈을 선정한다. (`mono_class_get_method_from_name`)
* kernel32.dll의 native function인 `ReadProcessMemory()`를 활용하여 변조 전 후 해당 주소값으로 부터의 1024 바이트를 확인한다.

## 코드 확인 및 변경
ObtainMonoExports() 함수 시작을 기점으로 Assembly로 변환된 user dll의 주소값을 가르키게된다.
```cs
private void ObtainMonoExports()
{
    foreach (ExportedFunction ef in ProcessUtils.GetExportedFunctions(_handle, _mono))
        if (Exports.ContainsKey(ef.Name))
        {
            Console.WriteLine(ef.Name)
            Exports[ef.Name] = ef.Address;
        }

    foreach (var kvp in Exports)
        if (kvp.Value == IntPtr.Zero)
          throw new InjectorException($"Failed to obtain the address of {kvp.Key}()");
}
  
public IntPtr Inject(byte[] rawAssembly, string @namespace, string className, string methodName)
{
    if (rawAssembly == null)
        throw new ArgumentNullException(nameof(rawAssembly));

    if (rawAssembly.Length == 0)
        throw new ArgumentException($"{nameof(rawAssembly)} cannot be empty", nameof(rawAssembly));

    if (className == null)
        throw new ArgumentNullException(nameof(className));

    if (methodName == null)
        throw new ArgumentNullException(nameof(methodName));

    IntPtr rawImage, assembly, image, @class, method;

    ObtainMonoExports();
    _rootDomain = GetRootDomain();
    rawImage = OpenImageFromData(rawAssembly);
    _attach = true;
    assembly = OpenAssemblyFromImage(rawImage);
    image = GetImageFromAssembly(assembly);
    @class = GetClassFromName(image, @namespace, className);
    method = GetMethodFromName(@class, methodName);
    RuntimeInvoke(method);
    return assembly;
}
```

따라서, 해당 address가 변조되기 전/후에 샘플 모듈의 메모리상 바이너리를 확인해본다
**Injector.cs**
```cs
        private void ObtainMonoExports()
        {
            foreach (ExportedFunction ef in ProcessUtils.GetExportedFunctions(_handle, _mono))
            {
                if (Exports.ContainsKey(ef.Name))
                {
                    Console.WriteLine("\t\t" + ef.Name + "  Addr : " + ef.Address);
                    Exports[ef.Name] = ef.Address;
                    if(ef.Name == mono_class_get_method_from_name)
                    {
                        _memory.CheckBinary(Exports[mono_class_get_method_from_name], 1024);
                    }
                }
                //Console.WriteLine(ef.Name + "  Addr : " + ef.Address);
            }
            foreach (var kvp in Exports)
            {
                //Console.WriteLine(kvp.Key);
                if (kvp.Value == IntPtr.Zero)
                {
                    throw new InjectorException($"Failed to obtain the address of {kvp.Key}()");
                }
            }
        }
        
        public IntPtr Inject(byte[] rawAssembly, string @namespace, string className, string methodName)
        {
            if (rawAssembly == null)
                throw new ArgumentNullException(nameof(rawAssembly));

            if (rawAssembly.Length == 0)
                throw new ArgumentException($"{nameof(rawAssembly)} cannot be empty", nameof(rawAssembly));

            if (className == null)
                throw new ArgumentNullException(nameof(className));

            if (methodName == null)
                throw new ArgumentNullException(nameof(methodName));

            IntPtr rawImage, assembly, image, @class, method;

            ObtainMonoExports();

            _rootDomain = GetRootDomain();
            rawImage = OpenImageFromData(rawAssembly);
            _attach = true;
            assembly = OpenAssemblyFromImage(rawImage);
            image = GetImageFromAssembly(assembly);
            @class = GetClassFromName(image, @namespace, className);
            method = GetMethodFromName(@class, methodName);

            _memory.CheckBinary(Exports[mono_class_get_method_from_name], 1024);
            _memory.CheckBinary(method, 1024);
            //Console.WriteLine(method)
            RuntimeInvoke(method);
            return assembly;
        }
```

**memory.cs**
```cs
        public void CheckBinary(IntPtr address, int length)
        {
            List<byte> bytes = new List<byte>();

            for (int i = 0; i < length; i++) {
                byte read = ReadBytes(address + bytes.Count, 1)[0];
                Console.WriteLine(ReadBytes(address + bytes.Count, 1)[0]);
                //Console.WriteLine(read);

                bytes.Add(read);
            }
        }
```

# mono.dll 메모리 확인

> 1. 실제 코드와 변조 전/후 차이가 존재함. 정상 상태의 바이너리 값은 지속적으로 동일하며, 변조 후는 동일 기능을 수행한다하더라도 바이너리 값이 회차마다 다름을 확인. (`아래 코드 블럭상 tail 확인 필요`)
> 
> 2. 메모리 상의 process를 읽고 로드된 mono.dll의 checksum을 비교하는 방식으로 변조 탐지가 가능할 것으로 보이나, 추가 확인이 필요할 수 있음.


<br>
<hr>
<br>

## 실행 회차 - 1
### [ 정상 실행 : mono\_class\_get\_method\_from\_name, 1024 byte] - 정상 실행 범위

```
85 139 236 106 0 255 117 16 255 117 12 255 117 8 232 145 247 255 255 131 196 16 93 195 85 139 236 131 236 12 131 125 12 0 83 86 87 139 248 117 8 161 192 139 31 16 137 69 12 187 184 0 0 0 83 255 117 12 232 215 153 1 0 1 29 116 141 31 16 139 93 16 89 89 139 240 133 219 116 8 139 67 4 137 70 48 235 40 139 69 8 15 183 64 4 106 16 255 117 12 137 69 16 232 170 153 1 0 255 117 16 137 70 48 104 248 88 19 16 80 232 176 102 15 0 131 196 20 106 0 86 199 70 52 151 233 28 16 232 229 99 4 0 51 210 89 89 137 85 16 59 218 116 19 139 67 16 235 10 57 16 116 10 131 192 4 255 69 16 59 194 117 242 137 85 252 57 85 16 126 36 139 67 16 139 0 246 64 92 32 117 25 138 136 142 0 0 0 128 249 19 116 14 128 249 30 116 9 199 69 252 1 0 0 0 235 41 59 218 116 32 246 67 8 8 116 26 104 232 70 19 16 104 220 40 19 16 255 53 192 139 31 16 232 56 251 255 255 131 196 12 235 5 161 196 139 31 16 137 70 36 139 69 16 43 69 252 137 69 244 133 192 126 80 139 77 16 43 77 252 193 224 2 80 255 117 12 102 137 78 64 232 238 152 1 0 129 78 28 0 0 1 0 137 70 84 139 69 252 89 89 137 69 248 59 69 16 125 35 131 101 252 0 139 75 16 139 4 129 139 77 252 139 86 84 131 69 252 4 137 4 17 139 69 248 64 137 69 248 59 69 16 124 225 139 69 12 51 201 65 9 78 20 247 223 27 255 131 231 11 131 199 19 193 231 16 51 190 140 0 0 0 137 78 92 129 231 0 0 255 0 51 190 140 0 0 0 137 70 44 139 70 20 139 207 193 249 16 136 142 130 0 0 0 139 77 8 129 142 128 0 0 0 0 0 0 64 137 54 137 118 4 137 190 140 0 0 0 137 142 136 0 0 0 137 78 124 133 219 116 5 139 91 12 235 2 51 219 106 4 95 11 199 86 137 94 88 198 70 24 1 137 126 16 137 70 20 232 226 119 255 255 131 125 244 0 89 126 63 255 118 36 232 33 234 255 255 139 70 36 128 120 32 0 89 116 31 104 216 88 19 16 104 150 20 0 0 104 120 68 19 16 104 176 162 30 16 87 106 0 232 211 45 254 255 131 196 24 139 70 36 255 112 60 86 232 198 208 255 255 89 89 95 139 198 94 91 201 195 85 139 236 83 139 93 8 86 87 139 59 232 243 162 1 0 133 255 116 25 139 51 247 222 27 246 141 67 12 35 240 131 62 0 116 35 232 62 163 1 0 139 6 235 98 51 246 51 201 232 26 127 9 0 137 69 8 133 192 116 43 232 37 163 1 0 139 69 8 235 72 139 77 12 133 201 117 26 139 71 12 57 77 16 116 7 133 192 116 12 139 64 8 133 192 116 5 139 72 44 235 2 51 201 139 69 16 86 81 83 232 118 253 255 255 131 196 12 139 216 133 255 116 2 137 30 232 228 162 1 0 106 0 83 232 28 98 4 0 89 89 139 195 95 94 91 93 195 85 139 236 139 69 8 15 190 72 6 141 81 255 131 250 29 15 135 141 1 0 0 255 36 149 142 229 1 16 139 0 133 192 15 133 168 1 0 0 161 196 139 31 16 93 195 139 0 133 192 15 133 151 1 0 0 161 204 139 31 16 93 195 139 0 133 192 15 133 134 1 0 0 161 208 139 31 16 93 195 139 0 133 192 15 133 117 1 0 0 161 0 140 31 16 93 195 139 0 133 192 15 133 100 1 0 0 161 212 139 31 16 93 195 139 0 133 192 15 133 83 1 0 0 161 200 139 31 16 93 195 139 0 133 192 15 133 66 1 0 0 161 216 139 31 16 93 195 139 0 133 192 15 133 49 1 0 0 161 220 139 31 16 93 195 139 0 133 192 15 133 32 1 0 0 161 224 139 31 16 93 195 139 0 133 192 15 133 15 1 0 0 161 228 139 31 16 93 195 139 0 133 192 15 133 254 0 0 0 161 232 139 31 16 93 195 139 0 133 192 15 133 237 0 0 0 161 236 139 31 16 93 195 139 0 133 192 15 133 220 0 0 0 161 240 139 31 16 93 195 139 0 133 192 15 133 203 0 0 0 161 244 139 31 16 93 195 139 0 133 192 15 133 186 0 0 0 161 248 139 31 16 93 195 139 0 133 192 15 133 169 0 0 0 161 252 139 31 16 93 195 139 0 133 192 15 133 152 0 0 0 161 4 140 31 16 93
```

### [ 정상 실행 : mono\_class\_get\_method\_from\_name, 1024 byte] - 변조 실패 (nProtect 동작, memory violation)

```
85 139 236 106 0 255 117 16 255 117 12 255 117 8 232 145 247 255 255 131 196 16 93 195 85 139 236 131 236 12 131 125 12 0 83 86 87 139 248 117 8 161 192 139 31 16 137 69 12 187 184 0 0 0 83 255 117 12 232 215 153 1 0 1 29 116 141 31 16 139 93 16 89 89 139 240 133 219 116 8 139 67 4 137 70 48 235 40 139 69 8 15 183 64 4 106 16 255 117 12 137 69 16 232 170 153 1 0 255 117 16 137 70 48 104 248 88 19 16 80 232 176 102 15 0 131 196 20 106 0 86 199 70 52 151 233 28 16 232 229 99 4 0 51 210 89 89 137 85 16 59 218 116 19 139 67 16 235 10 57 16 116 10 131 192 4 255 69 16 59 194 117 242 137 85 252 57 85 16 126 36 139 67 16 139 0 246 64 92 32 117 25 138 136 142 0 0 0 128 249 19 116 14 128 249 30 116 9 199 69 252 1 0 0 0 235 41 59 218 116 32 246 67 8 8 116 26 104 232 70 19 16 104 220 40 19 16 255 53 192 139 31 16 232 56 251 255 255 131 196 12 235 5 161 196 139 31 16 137 70 36 139 69 16 43 69 252 137 69 244 133 192 126 80 139 77 16 43 77 252 193 224 2 80 255 117 12 102 137 78 64 232 238 152 1 0 129 78 28 0 0 1 0 137 70 84 139 69 252 89 89 137 69 248 59 69 16 125 35 131 101 252 0 139 75 16 139 4 129 139 77 252 139 86 84 131 69 252 4 137 4 17 139 69 248 64 137 69 248 59 69 16 124 225 139 69 12 51 201 65 9 78 20 247 223 27 255 131 231 11 131 199 19 193 231 16 51 190 140 0 0 0 137 78 92 129 231 0 0 255 0 51 190 140 0 0 0 137 70 44 139 70 20 139 207 193 249 16 136 142 130 0 0 0 139 77 8 129 142 128 0 0 0 0 0 0 64 137 54 137 118 4 137 190 140 0 0 0 137 142 136 0 0 0 137 78 124 133 219 116 5 139 91 12 235 2 51 219 106 4 95 11 199 86 137 94 88 198 70 24 1 137 126 16 137 70 20 232 226 119 255 255 131 125 244 0 89 126 63 255 118 36 232 33 234 255 255 139 70 36 128 120 32 0 89 116 31 104 216 88 19 16 104 150 20 0 0 104 120 68 19 16 104 176 162 30 16 87 106 0 232 211 45 254 255 131 196 24 139 70 36 255 112 60 86 232 198 208 255 255 89 89 95 139 198 94 91 201 195 85 139 236 83 139 93 8 86 87 139 59 232 243 162 1 0 133 255 116 25 139 51 247 222 27 246 141 67 12 35 240 131 62 0 116 35 232 62 163 1 0 139 6 235 98 51 246 51 201 232 26 127 9 0 137 69 8 133 192 116 43 232 37 163 1 0 139 69 8 235 72 139 77 12 133 201 117 26 139 71 12 57 77 16 116 7 133 192 116 12 139 64 8 133 192 116 5 139 72 44 235 2 51 201 139 69 16 86 81 83 232 118 253 255 255 131 196 12 139 216 133 255 116 2 137 30 232 228 162 1 0 106 0 83 232 28 98 4 0 89 89 139 195 95 94 91 93 195 85 139 236 139 69 8 15 190 72 6 141 81 255 131 250 29 15 135 141 1 0 0 255 36 149 142 229 1 16 139 0 133 192 15 133 168 1 0 0 161 196 139 31 16 93 195 139 0 133 192 15 133 151 1 0 0 161 204 139 31 16 93 195 139 0 133 192 15 133 134 1 0 0 161 208 139 31 16 93 195 139 0 133 192 15 133 117 1 0 0 161 0 140 31 16 93 195 139 0 133 192 15 133 100 1 0 0 161 212 139 31 16 93 195 139 0 133 192 15 133 83 1 0 0 161 200 139 31 16 93 195 139 0 133 192 15 133 66 1 0 0 161 216 139 31 16 93 195 139 0 133 192 15 133 49 1 0 0 161 220 139 31 16 93 195 139 0 133 192 15 133 32 1 0 0 161 224 139 31 16 93 195 139 0 133 192 15 133 15 1 0 0 161 228 139 31 16 93 195 139 0 133 192 15 133 254 0 0 0 161 232 139 31 16 93 195 139 0 133 192 15 133 237 0 0 0 161 236 139 31 16 93 195 139 0 133 192 15 133 220 0 0 0 161 240 139 31 16 93 195 139 0 133 192 15 133 203 0 0 0 161 244 139 31 16 93 195 139 0 133 192 15 133 186 0 0 0 161 248 139 31 16 93 195 139 0 133 192 15 133 169 0 0 0 161 252 139 31 16 93 195 139 0 133 192 15 133 152 0 0 0 161 4 140 31 16 93
```

<br>
<hr>
<br>

## 실행회차 - 2
### [ 정상 실행 : mono\_class\_get\_method\_from\_name, 1024 byte] - 정상 실행 범위

```
85 139 236 106 0 255 117 16 255 117 12 255 117 8 232 145 247 255 255 131 196 16 93 195 85 139 236 131 236 12 131 125 12 0 83 86 87 139 248 117 8 161 192 139 31 16 137 69 12 187 184 0 0 0 83 255 117 12 232 215 153 1 0 1 29 116 141 31 16 139 93 16 89 89 139 240 133 219 116 8 139 67 4 137 70 48 235 40 139 69 8 15 183 64 4 106 16 255 117 12 137 69 16 232 170 153 1 0 255 117 16 137 70 48 104 248 88 19 16 80 232 176 102 15 0 131 196 20 106 0 86 199 70 52 151 233 28 16 232 229 99 4 0 51 210 89 89 137 85 16 59 218 116 19 139 67 16 235 10 57 16 116 10 131 192 4 255 69 16 59 194 117 242 137 85 252 57 85 16 126 36 139 67 16 139 0 246 64 92 32 117 25 138 136 142 0 0 0 128 249 19 116 14 128 249 30 116 9 199 69 252 1 0 0 0 235 41 59 218 116 32 246 67 8 8 116 26 104 232 70 19 16 104 220 40 19 16 255 53 192 139 31 16 232 56 251 255 255 131 196 12 235 5 161 196 139 31 16 137 70 36 139 69 16 43 69 252 137 69 244 133 192 126 80 139 77 16 43 77 252 193 224 2 80 255 117 12 102 137 78 64 232 238 152 1 0 129 78 28 0 0 1 0 137 70 84 139 69 252 89 89 137 69 248 59 69 16 125 35 131 101 252 0 139 75 16 139 4 129 139 77 252 139 86 84 131 69 252 4 137 4 17 139 69 248 64 137 69 248 59 69 16 124 225 139 69 12 51 201 65 9 78 20 247 223 27 255 131 231 11 131 199 19 193 231 16 51 190 140 0 0 0 137 78 92 129 231 0 0 255 0 51 190 140 0 0 0 137 70 44 139 70 20 139 207 193 249 16 136 142 130 0 0 0 139 77 8 129 142 128 0 0 0 0 0 0 64 137 54 137 118 4 137 190 140 0 0 0 137 142 136 0 0 0 137 78 124 133 219 116 5 139 91 12 235 2 51 219 106 4 95 11 199 86 137 94 88 198 70 24 1 137 126 16 137 70 20 232 226 119 255 255 131 125 244 0 89 126 63 255 118 36 232 33 234 255 255 139 70 36 128 120 32 0 89 116 31 104 216 88 19 16 104 150 20 0 0 104 120 68 19 16 104 176 162 30 16 87 106 0 232 211 45 254 255 131 196 24 139 70 36 255 112 60 86 232 198 208 255 255 89 89 95 139 198 94 91 201 195 85 139 236 83 139 93 8 86 87 139 59 232 243 162 1 0 133 255 116 25 139 51 247 222 27 246 141 67 12 35 240 131 62 0 116 35 232 62 163 1 0 139 6 235 98 51 246 51 201 232 26 127 9 0 137 69 8 133 192 116 43 232 37 163 1 0 139 69 8 235 72 139 77 12 133 201 117 26 139 71 12 57 77 16 116 7 133 192 116 12 139 64 8 133 192 116 5 139 72 44 235 2 51 201 139 69 16 86 81 83 232 118 253 255 255 131 196 12 139 216 133 255 116 2 137 30 232 228 162 1 0 106 0 83 232 28 98 4 0 89 89 139 195 95 94 91 93 195 85 139 236 139 69 8 15 190 72 6 141 81 255 131 250 29 15 135 141 1 0 0 255 36 149 142 229 1 16 139 0 133 192 15 133 168 1 0 0 161 196 139 31 16 93 195 139 0 133 192 15 133 151 1 0 0 161 204 139 31 16 93 195 139 0 133 192 15 133 134 1 0 0 161 208 139 31 16 93 195 139 0 133 192 15 133 117 1 0 0 161 0 140 31 16 93 195 139 0 133 192 15 133 100 1 0 0 161 212 139 31 16 93 195 139 0 133 192 15 133 83 1 0 0 161 200 139 31 16 93 195 139 0 133 192 15 133 66 1 0 0 161 216 139 31 16 93 195 139 0 133 192 15 133 49 1 0 0 161 220 139 31 16 93 195 139 0 133 192 15 133 32 1 0 0 161 224 139 31 16 93 195 139 0 133 192 15 133 15 1 0 0 161 228 139 31 16 93 195 139 0 133 192 15 133 254 0 0 0 161 232 139 31 16 93 195 139 0 133 192 15 133 237 0 0 0 161 236 139 31 16 93 195 139 0 133 192 15 133 220 0 0 0 161 240 139 31 16 93 195 139 0 133 192 15 133 203 0 0 0 161 244 139 31 16 93 195 139 0 133 192 15 133 186 0 0 0 161 248 139 31 16 93 195 139 0 133 192 15 133 169 0 0 0 161 252 139 31 16 93 195 139 0 133 192 15 133 152 0 0 0 161 4 140 31 16 93
```

### [ 변조 실행 : mono\_class\_get\_method\_from\_name, 1024 byte] - 변조 성공 후

```
85 139 236 106 0 255 117 16 255 117 12 255 117 8 232 145 247 255 255 131 196 16 93 195 85 139 236 131 236 12 131 125 12 0 83 86 87 139 248 117 8 161 192 139 31 16 137 69 12 187 184 0 0 0 83 255 117 12 232 215 153 1 0 1 29 116 141 31 16 139 93 16 89 89 139 240 133 219 116 8 139 67 4 137 70 48 235 40 139 69 8 15 183 64 4 106 16 255 117 12 137 69 16 232 170 153 1 0 255 117 16 137 70 48 104 248 88 19 16 80 232 176 102 15 0 131 196 20 106 0 86 199 70 52 151 233 28 16 232 229 99 4 0 51 210 89 89 137 85 16 59 218 116 19 139 67 16 235 10 57 16 116 10 131 192 4 255 69 16 59 194 117 242 137 85 252 57 85 16 126 36 139 67 16 139 0 246 64 92 32 117 25 138 136 142 0 0 0 128 249 19 116 14 128 249 30 116 9 199 69 252 1 0 0 0 235 41 59 218 116 32 246 67 8 8 116 26 104 232 70 19 16 104 220 40 19 16 255 53 192 139 31 16 232 56 251 255 255 131 196 12 235 5 161 196 139 31 16 137 70 36 139 69 16 43 69 252 137 69 244 133 192 126 80 139 77 16 43 77 252 193 224 2 80 255 117 12 102 137 78 64 232 238 152 1 0 129 78 28 0 0 1 0 137 70 84 139 69 252 89 89 137 69 248 59 69 16 125 35 131 101 252 0 139 75 16 139 4 129 139 77 252 139 86 84 131 69 252 4 137 4 17 139 69 248 64 137 69 248 59 69 16 124 225 139 69 12 51 201 65 9 78 20 247 223 27 255 131 231 11 131 199 19 193 231 16 51 190 140 0 0 0 137 78 92 129 231 0 0 255 0 51 190 140 0 0 0 137 70 44 139 70 20 139 207 193 249 16 136 142 130 0 0 0 139 77 8 129 142 128 0 0 0 0 0 0 64 137 54 137 118 4 137 190 140 0 0 0 137 142 136 0 0 0 137 78 124 133 219 116 5 139 91 12 235 2 51 219 106 4 95 11 199 86 137 94 88 198 70 24 1 137 126 16 137 70 20 232 226 119 255 255 131 125 244 0 89 126 63 255 118 36 232 33 234 255 255 139 70 36 128 120 32 0 89 116 31 104 216 88 19 16 104 150 20 0 0 104 120 68 19 16 104 176 162 30 16 87 106 0 232 211 45 254 255 131 196 24 139 70 36 255 112 60 86 232 198 208 255 255 89 89 95 139 198 94 91 201 195 85 139 236 83 139 93 8 86 87 139 59 232 243 162 1 0 133 255 116 25 139 51 247 222 27 246 141 67 12 35 240 131 62 0 116 35 232 62 163 1 0 139 6 235 98 51 246 51 201 232 26 127 9 0 137 69 8 133 192 116 43 232 37 163 1 0 139 69 8 235 72 139 77 12 133 201 117 26 139 71 12 57 77 16 116 7 133 192 116 12 139 64 8 133 192 116 5 139 72 44 235 2 51 201 139 69 16 86 81 83 232 118 253 255 255 131 196 12 139 216 133 255 116 2 137 30 232 228 162 1 0 106 0 83 232 28 98 4 0 89 89 139 195 95 94 91 93 195 85 139 236 139 69 8 15 190 72 6 141 81 255 131 250 29 15 135 141 1 0 0 255 36 149 142 229 1 16 139 0 133 192 15 133 168 1 0 0 161 196 139 31 16 93 195 139 0 133 192 15 133 151 1 0 0 161 204 139 31 16 93 195 139 0 133 192 15 133 134 1 0 0 161 208 139 31 16 93 195 139 0 133 192 15 133 117 1 0 0 161 0 140 31 16 93 195 139 0 133 192 15 133 100 1 0 0 161 212 139 31 16 93 195 139 0 133 192 15 133 83 1 0 0 161 200 139 31 16 93 195 139 0 133 192 15 133 66 1 0 0 161 216 139 31 16 93 195 139 0 133 192 15 133 49 1 0 0 161 220 139 31 16 93 195 139 0 133 192 15 133 32 1 0 0 161 224 139 31 16 93 195 139 0 133 192 15 133 15 1 0 0 161 228 139 31 16 93 195 139 0 133 192 15 133 254 0 0 0 161 232 139 31 16 93 195 139 0 133 192 15 133 237 0 0 0 161 236 139 31 16 93 195 139 0 133 192 15 133 220 0 0 0 161 240 139 31 16 93 195 139 0 133 192 15 133 203 0 0 0 161 244 139 31 16 93 195 139 0 133 192 15 133 186 0 0 0 161 248 139 31 16 93 195 139 0 133 192 15 133 169 0 0 0 161 252 139 31 16 93 195 139 0 133 192 15 133 152 0 0 0 161 4 140 31 16 93 150 0 0 0 3 0 0 6 248 218 207 18 8 220 207 18 218 37 31 15 0 128 255 255 0 0 0 0 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 80 19 26 16 209 26 171 13 72 31 254 4 155 0 0 0 155 0 0 0 11 0 0 0 124 0 0 0 192 0 0 0 255 105 209 3 0 0 0 0 2 0 0 0 17 0 0 0 0 0 0 0 0 0 0 0 16 0 0 0 5 0 0 0 0 0 0 0 16 0 0 0 0 0 0 0 0 0 0 0 240 88 172 18 0 0 0 0 0 198 43 15 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 144 143 172 18 152 60 182 18 0 4 0 0 96 114 172 18 64 0 0 0 40 66 206 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 217 207 34 133 255 7 0 128 0 215 113 13 72 10 71 15 224 92 254 18 88 90 96 18 152 11 71 15 16 17 71 15 176 17 71 15 112 31 71 15 128 21 72 15 48 14 71 15 0 0 0 0 80 20 71 15 0 0 0 0 184 216 253 18 96 193 71 15 0 0 0 0 21 0 0 0 3 0 0 0 14 0 0 0 64 0 0 0 40 0 0 0 0 0 0 0 182 0 0 0 0 0 0 0 0 0 0 0 168 253 251 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 224 12 71 15 0 0 0 0 88 12 71 15 8 17 71 15 0 215 113 13 0 215 113 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 112 78 162 4 181 0 0 0 0 0 0 0 113 0 0 0 0 0 0 0 76 191 183 4 64 223 1 5 219 1 0 0 219 1 0 0 9 0 0 0 129 1 0 0 200 0 0 0 255 105 209 3 0 0 0 0 130 0 0 0 17 0 0 0 0 0 0 0 0 0 0 0 16 0 0 0 5 0 0 0 0 0 0 0 16 0 0 0 0 0 0 0 0 0 0 0 104 10 71 15 0 0 0 0 240 225 43 15 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 136 214 253 18 120 99 136 18 0 4 0 0 16 19 72 15 128 0 0 0 0 215 113 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 158 207 229 134 255 8 0 128 168 230 69 15 72 10 71 15 64 105 254 18 120 146 96 18 104 11 71 15 0 13 71 15 160 13 71 15 224 14 71 15 240 23 71 15 128 12 71 15 0 0 0 0 64 16 71 15 0 0 0 0 152 33 71 15 224 197 71 15 0 0 0 0 5 0 0 0 1 0 0 0 2 0 0 0 64 0 0 0 36 0 0 0 0 0 0 0 32 0 0 0 0 0 0 0 0 0 0 0 8 1 252 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 40 12 71 15 0 0 0 0
```
<br>
<hr>
<br>

## 실행회차 - 3
### [ 정상 실행 : mono\_class\_get\_method\_from\_name, 1024 byte] - 정상 실행 범위

```
85 139 236 106 0 255 117 16 255 117 12 255 117 8 232 145 247 255 255 131 196 16 93 195 85 139 236 131 236 12 131 125 12 0 83 86 87 139 248 117 8 161 192 139 31 16 137 69 12 187 184 0 0 0 83 255 117 12 232 215 153 1 0 1 29 116 141 31 16 139 93 16 89 89 139 240 133 219 116 8 139 67 4 137 70 48 235 40 139 69 8 15 183 64 4 106 16 255 117 12 137 69 16 232 170 153 1 0 255 117 16 137 70 48 104 248 88 19 16 80 232 176 102 15 0 131 196 20 106 0 86 199 70 52 151 233 28 16 232 229 99 4 0 51 210 89 89 137 85 16 59 218 116 19 139 67 16 235 10 57 16 116 10 131 192 4 255 69 16 59 194 117 242 137 85 252 57 85 16 126 36 139 67 16 139 0 246 64 92 32 117 25 138 136 142 0 0 0 128 249 19 116 14 128 249 30 116 9 199 69 252 1 0 0 0 235 41 59 218 116 32 246 67 8 8 116 26 104 232 70 19 16 104 220 40 19 16 255 53 192 139 31 16 232 56 251 255 255 131 196 12 235 5 161 196 139 31 16 137 70 36 139 69 16 43 69 252 137 69 244 133 192 126 80 139 77 16 43 77 252 193 224 2 80 255 117 12 102 137 78 64 232 238 152 1 0 129 78 28 0 0 1 0 137 70 84 139 69 252 89 89 137 69 248 59 69 16 125 35 131 101 252 0 139 75 16 139 4 129 139 77 252 139 86 84 131 69 252 4 137 4 17 139 69 248 64 137 69 248 59 69 16 124 225 139 69 12 51 201 65 9 78 20 247 223 27 255 131 231 11 131 199 19 193 231 16 51 190 140 0 0 0 137 78 92 129 231 0 0 255 0 51 190 140 0 0 0 137 70 44 139 70 20 139 207 193 249 16 136 142 130 0 0 0 139 77 8 129 142 128 0 0 0 0 0 0 64 137 54 137 118 4 137 190 140 0 0 0 137 142 136 0 0 0 137 78 124 133 219 116 5 139 91 12 235 2 51 219 106 4 95 11 199 86 137 94 88 198 70 24 1 137 126 16 137 70 20 232 226 119 255 255 131 125 244 0 89 126 63 255 118 36 232 33 234 255 255 139 70 36 128 120 32 0 89 116 31 104 216 88 19 16 104 150 20 0 0 104 120 68 19 16 104 176 162 30 16 87 106 0 232 211 45 254 255 131 196 24 139 70 36 255 112 60 86 232 198 208 255 255 89 89 95 139 198 94 91 201 195 85 139 236 83 139 93 8 86 87 139 59 232 243 162 1 0 133 255 116 25 139 51 247 222 27 246 141 67 12 35 240 131 62 0 116 35 232 62 163 1 0 139 6 235 98 51 246 51 201 232 26 127 9 0 137 69 8 133 192 116 43 232 37 163 1 0 139 69 8 235 72 139 77 12 133 201 117 26 139 71 12 57 77 16 116 7 133 192 116 12 139 64 8 133 192 116 5 139 72 44 235 2 51 201 139 69 16 86 81 83 232 118 253 255 255 131 196 12 139 216 133 255 116 2 137 30 232 228 162 1 0 106 0 83 232 28 98 4 0 89 89 139 195 95 94 91 93 195 85 139 236 139 69 8 15 190 72 6 141 81 255 131 250 29 15 135 141 1 0 0 255 36 149 142 229 1 16 139 0 133 192 15 133 168 1 0 0 161 196 139 31 16 93 195 139 0 133 192 15 133 151 1 0 0 161 204 139 31 16 93 195 139 0 133 192 15 133 134 1 0 0 161 208 139 31 16 93 195 139 0 133 192 15 133 117 1 0 0 161 0 140 31 16 93 195 139 0 133 192 15 133 100 1 0 0 161 212 139 31 16 93 195 139 0 133 192 15 133 83 1 0 0 161 200 139 31 16 93 195 139 0 133 192 15 133 66 1 0 0 161 216 139 31 16 93 195 139 0 133 192 15 133 49 1 0 0 161 220 139 31 16 93 195 139 0 133 192 15 133 32 1 0 0 161 224 139 31 16 93 195 139 0 133 192 15 133 15 1 0 0 161 228 139 31 16 93 195 139 0 133 192 15 133 254 0 0 0 161 232 139 31 16 93 195 139 0 133 192 15 133 237 0 0 0 161 236 139 31 16 93 195 139 0 133 192 15 133 220 0 0 0 161 240 139 31 16 93 195 139 0 133 192 15 133 203 0 0 0 161 244 139 31 16 93 195 139 0 133 192 15 133 186 0 0 0 161 248 139 31 16 93 195 139 0 133 192 15 133 169 0 0 0 161 252 139 31 16 93 195 139 0 133 192 15 133 152 0 0 0 161 4 140 31 16 93
```

### [ 변조 실행 : mono\_class\_get\_method\_from\_name, 1024 byte] - 변조 성공 후

```
85 139 236 106 0 255 117 16 255 117 12 255 117 8 232 145 247 255 255 131 196 16 93 195 85 139 236 131 236 12 131 125 12 0 83 86 87 139 248 117 8 161 192 139 31 16 137 69 12 187 184 0 0 0 83 255 117 12 232 215 153 1 0 1 29 116 141 31 16 139 93 16 89 89 139 240 133 219 116 8 139 67 4 137 70 48 235 40 139 69 8 15 183 64 4 106 16 255 117 12 137 69 16 232 170 153 1 0 255 117 16 137 70 48 104 248 88 19 16 80 232 176 102 15 0 131 196 20 106 0 86 199 70 52 151 233 28 16 232 229 99 4 0 51 210 89 89 137 85 16 59 218 116 19 139 67 16 235 10 57 16 116 10 131 192 4 255 69 16 59 194 117 242 137 85 252 57 85 16 126 36 139 67 16 139 0 246 64 92 32 117 25 138 136 142 0 0 0 128 249 19 116 14 128 249 30 116 9 199 69 252 1 0 0 0 235 41 59 218 116 32 246 67 8 8 116 26 104 232 70 19 16 104 220 40 19 16 255 53 192 139 31 16 232 56 251 255 255 131 196 12 235 5 161 196 139 31 16 137 70 36 139 69 16 43 69 252 137 69 244 133 192 126 80 139 77 16 43 77 252 193 224 2 80 255 117 12 102 137 78 64 232 238 152 1 0 129 78 28 0 0 1 0 137 70 84 139 69 252 89 89 137 69 248 59 69 16 125 35 131 101 252 0 139 75 16 139 4 129 139 77 252 139 86 84 131 69 252 4 137 4 17 139 69 248 64 137 69 248 59 69 16 124 225 139 69 12 51 201 65 9 78 20 247 223 27 255 131 231 11 131 199 19 193 231 16 51 190 140 0 0 0 137 78 92 129 231 0 0 255 0 51 190 140 0 0 0 137 70 44 139 70 20 139 207 193 249 16 136 142 130 0 0 0 139 77 8 129 142 128 0 0 0 0 0 0 64 137 54 137 118 4 137 190 140 0 0 0 137 142 136 0 0 0 137 78 124 133 219 116 5 139 91 12 235 2 51 219 106 4 95 11 199 86 137 94 88 198 70 24 1 137 126 16 137 70 20 232 226 119 255 255 131 125 244 0 89 126 63 255 118 36 232 33 234 255 255 139 70 36 128 120 32 0 89 116 31 104 216 88 19 16 104 150 20 0 0 104 120 68 19 16 104 176 162 30 16 87 106 0 232 211 45 254 255 131 196 24 139 70 36 255 112 60 86 232 198 208 255 255 89 89 95 139 198 94 91 201 195 85 139 236 83 139 93 8 86 87 139 59 232 243 162 1 0 133 255 116 25 139 51 247 222 27 246 141 67 12 35 240 131 62 0 116 35 232 62 163 1 0 139 6 235 98 51 246 51 201 232 26 127 9 0 137 69 8 133 192 116 43 232 37 163 1 0 139 69 8 235 72 139 77 12 133 201 117 26 139 71 12 57 77 16 116 7 133 192 116 12 139 64 8 133 192 116 5 139 72 44 235 2 51 201 139 69 16 86 81 83 232 118 253 255 255 131 196 12 139 216 133 255 116 2 137 30 232 228 162 1 0 106 0 83 232 28 98 4 0 89 89 139 195 95 94 91 93 195 85 139 236 139 69 8 15 190 72 6 141 81 255 131 250 29 15 135 141 1 0 0 255 36 149 142 229 1 16 139 0 133 192 15 133 168 1 0 0 161 196 139 31 16 93 195 139 0 133 192 15 133 151 1 0 0 161 204 139 31 16 93 195 139 0 133 192 15 133 134 1 0 0 161 208 139 31 16 93 195 139 0 133 192 15 133 117 1 0 0 161 0 140 31 16 93 195 139 0 133 192 15 133 100 1 0 0 161 212 139 31 16 93 195 139 0 133 192 15 133 83 1 0 0 161 200 139 31 16 93 195 139 0 133 192 15 133 66 1 0 0 161 216 139 31 16 93 195 139 0 133 192 15 133 49 1 0 0 161 220 139 31 16 93 195 139 0 133 192 15 133 32 1 0 0 161 224 139 31 16 93 195 139 0 133 192 15 133 15 1 0 0 161 228 139 31 16 93 195 139 0 133 192 15 133 254 0 0 0 161 232 139 31 16 93 195 139 0 133 192 15 133 237 0 0 0 161 236 139 31 16 93 195 139 0 133 192 15 133 220 0 0 0 161 240 139 31 16 93 195 139 0 133 192 15 133 203 0 0 0 161 244 139 31 16 93 195 139 0 133 192 15 133 186 0 0 0 161 248 139 31 16 93 195 139 0 133 192 15 133 169 0 0 0 161 252 139 31 16 93 195 139 0 133 192 15 133 152 0 0 0 161 4 140 31 16 93 150 0 0 0 3 0 0 6 248 218 207 18 8 220 207 18 218 37 31 15 0 128 255 255 40 220 207 18 0 0 0 0 0 0 0 0 0 0 255 255 0 0 0 0 80 19 26 16 1 0 0 0 48 198 71 15 0 0 0 0 0 0 0 0 34 0 0 0 177 34 31 15 8 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 255 255 0 0 0 0 80 19 26 16 5 0 0 0 0 0 0 0 16 0 0 0 0 0 0 0 0 0 0 0 240 88 172 18 0 0 0 0 0 198 43 15 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 144 143 172 18 152 60 182 18 0 4 0 0 96 114 172 18 64 0 0 0 40 66 206 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 217 207 34 133 255 7 0 128 128 14 115 13 168 138 72 15 24 100 254 18 88 90 96 18 72 139 72 15 64 141 72 15 224 141 72 15 8 149 72 15 120 155 72 15 16 141 72 15 0 0 0 0 224 141 72 15 0 0 0 0 176 163 72 15 32 17 71 15 0 0 0 0 3 0 0 0 3 0 0 0 3 0 0 0 64 0 0 0 0 0 0 0 0 0 0 0 9 0 0 0 0 0 0 0 0 0 0 0 104 13 252 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 192 162 59 15 0 0 0 0 240 161 59 15 48 197 157 18 136 177 60 15 136 177 60 15 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 112 78 162 4 110 1 0 0 0 0 0 0 144 0 0 0 0 0 0 0 28 151 83 14 200 194 122 20 153 2 0 0 153 2 0 0 12 0 0 0 95 2 0 0 200 0 0 0 255 105 209 3 0 0 0 0 2 1 0 0 17 0 0 0 0 0 0 0 0 0 0 0 16 0 0 0 5 0 0 0 0 0 0 0 16 0 0 0 0 0 0 0 0 0 0 0 72 189 157 18 0 0 0 0 112 233 43 15 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 32 226 158 18 96 205 135 18 0 4 0 0 176 248 157 18 64 0 0 0 136 177 60 15 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 158 207 229 134 255 8 0 128 72 133 59 15 48 134 59 15 112 134 59 15 176 134 59 15 240 134 59 15 48 135 59 15 112 135 59 15 176 135 59 15 240 135 59 15 48 136 59 15 200 136 59 15 8 137 59 15 72 137 59 15 136 137 59 15 200 137 59 15 8 138 59 15 72 138 59 15 136 138 59 15 200 138 59 15 8 139 59 15 72 139 59 15 136 139 59 15 200 139 59 15 8 140 59 15 72 140 59 15 136 141 59 15 200 141 59 15 8 142 59 15 72 142 59 15 136 142 59 15 200 142 59 15 8 143 59 15 96 182 59 15 72 136 61 15 136 136 61 15 232 55 60 15 144 57 60 15 176 162 59 15 88 166 59 15 96 182 59 15 96 110 60 15 8 116 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 184 189 158 18 0 0 0 0
```